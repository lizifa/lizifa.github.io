import{_ as lt,o as F,d as V,F as rt,e as ct,p as G,q as K,s as Q,v as Z,k as dt,g as ut,r as tt,a as A,l as _,w as B,b as X}from"./index-ec830cba.js";function et(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Function]"}function Y(t,e,i,s=1){const o=Math.round(e/s/t[0])*t[0],h=Math.round(i/s/t[1])*t[1];return[o,h]}function it(t,e,i){return t-e-i}function st(t,e,i){return t-e-i}function T(t,e,i){return e!==null&&t<e?e:i!==null&&i<t?i:t}function $(t,e,i,s,o){const h=Math.PI/180*o,l=Math.cos(h),c=Math.sin(h);let n=i-t,r=s-e;return{x:n*l-r*c+t,y:n*c+r*l+e}}function mt(t,e){let i=Math.atan2(e,t);return i=Math.round(180/Math.PI*i),i<0&&(i=360+i),i}function ot(t,e,i){let s=t;const o=["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].find(h=>et(s[h]));if(!et(s[o]))return!1;do{if(s[o](e))return!0;if(s===i)return!1;s=s.parentNode}while(s);return!1}function pt(t){const e=window.getComputedStyle(t);return[parseFloat(e.getPropertyValue("width"),10),parseFloat(e.getPropertyValue("height"),10)]}function P(t,e,i){t&&(t.attachEvent?t.attachEvent("on"+e,i):t.addEventListener?t.addEventListener(e,i,!0):t["on"+e]=i)}function C(t,e,i){t&&(t.detachEvent?t.detachEvent("on"+e,i):t.removeEventListener?t.removeEventListener(e,i,!0):t["on"+e]=null)}const I={mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"},touch:{start:"touchstart",move:"touchmove",stop:"touchend"}},ft={userSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",MsUserSelect:"none"},gt={userSelect:"auto",MozUserSelect:"auto",WebkitUserSelect:"auto",MsUserSelect:"auto"};let W=I.mouse;const xt={replace:!0,name:"Element",props:{className:{type:String,default:"vdr"},classNameDraggable:{type:String,default:"draggable"},classNameResizable:{type:String,default:"resizable"},classNameRotatable:{type:String,default:"rotatable"},classNameDragging:{type:String,default:"dragging"},classNameResizing:{type:String,default:"resizing"},classNameRotating:{type:String,default:"rotating"},classNameActive:{type:String,default:"active"},classNameHandle:{type:String,default:"handle"},disableUserSelect:{type:Boolean,default:!0},enableNativeDrag:{type:Boolean,default:!1},preventDeactivation:{type:Boolean,default:!1},active:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},rotatable:{type:Boolean,default:!1},lockAspectRatio:{type:Boolean,default:!1},outsideAspectRatio:{type:[Number,String],default:0},w:{type:[Number,String],default:414,validator:t=>typeof t=="number"?t>0:t==="auto"},h:{type:[Number,String],default:100,validator:t=>typeof t=="number"?t>0:t==="auto"},minWidth:{type:Number,default:0,validator:t=>t>=0},minHeight:{type:Number,default:0,validator:t=>t>=0},maxWidth:{type:Number,default:1/0,validator:t=>t>=0},maxHeight:{type:Number,default:1/0,validator:t=>t>=0},x:{type:[String,Number],default:0},y:{type:[String,Number],default:0},z:{type:[String,Number],default:"auto",validator:t=>typeof t=="string"?t==="auto":t>=0},r:{type:[String,Number],default:0},handles:{type:Array,default:()=>["tl","tm","tr","mr","br","bm","bl","ml","rot"],validator:t=>{const e=new Set(["tl","tm","tr","mr","br","bm","bl","ml","rot"]);return new Set(t.filter(i=>e.has(i))).size===t.length}},dragHandle:{type:String,default:null},dragCancel:{type:String,default:null},axis:{type:String,default:"both",validator:t=>["x","y","both"].includes(t)},grid:{type:Array,default:()=>[1,1]},parent:{type:[Boolean,String],default:!1},onDragStart:{type:Function,default:()=>!0},onDrag:{type:Function,default:()=>!0},onResizeStart:{type:Function,default:()=>!0},onResize:{type:Function,default:()=>!0},onRotateStart:{type:Function,default:()=>!0},onRotate:{type:Function,default:()=>!0},isConflictCheck:{type:Boolean,default:!1},snap:{type:Boolean,default:!1},snapBorder:{type:Boolean,default:!1},snapTolerance:{type:Number,default:5,validator:function(t){return typeof t=="number"}},scaleRatio:{type:Number,default:1,validator:t=>typeof t=="number"},handleInfo:{type:Object,default:()=>({size:8,offset:-4,switch:!0})}},data(){return{left:this.x,top:this.y,right:null,bottom:null,rotate:this.r,width:null,height:null,widthTouched:!1,heightTouched:!1,aspectFactor:null,parentWidth:null,parentHeight:null,minW:this.minWidth,minH:this.minHeight,maxW:this.maxWidth,maxH:this.maxHeight,handle:null,enabled:this.active,resizing:!1,dragging:!1,rotating:!1,zIndex:this.z,lastCenterX:0,lastCenterY:0,parentX:0,parentY:0}},computed:{handleStyle(){return t=>{if(!this.handleInfo.switch)return{display:this.enabled?"block":"none"};if(t==="rot"&&!this.rotatable)return{display:"none"};if(t!=="rot"&&!this.resizable)return{display:"none"};const e=(this.handleInfo.size/this.scaleRatio).toFixed(2),i=(this.handleInfo.offset/this.scaleRatio).toFixed(2),s=(e/2).toFixed(2),o={tl:{top:`${i}px`,left:`${i}px`},tm:{top:`${i}px`,left:`calc(50% - ${s}px)`},tr:{top:`${i}px`,right:`${i}px`},mr:{top:`calc(50% - ${s}px)`,right:`${i}px`},br:{bottom:`${i}px`,right:`${i}px`},bm:{bottom:`${i}px`,right:`calc(50% - ${s}px)`},bl:{bottom:`${i}px`,left:`${i}px`},ml:{top:`calc(50% - ${s}px)`,left:`${i}px`},rot:{top:`-${e*3}px`,left:"50%"}},h={width:o[t].width||`${e}px`,height:o[t].height||`${e}px`,top:o[t].top,left:o[t].left,right:o[t].right,bottom:o[t].bottom},l={tl:0,tm:1,tr:2,mr:3,br:4,bm:5,bl:6,ml:7,rot:8};if(t!=="rot"){const c=["nw-resize","n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize"],r=this.rotate+22.5,u=Math.floor(r/45);let p=(l[t]+u)%8;h.cursor=c[p]}return h.display=this.enabled?"block":"none",h}},style(){return{background:"#f00",transform:`translate(${this.left}px, ${this.top}px) rotate(${this.rotate}deg)`,width:this.computedWidth,height:this.computedHeight,zIndex:this.zIndex,fontSize:this.handleInfo.size*2+"px",...this.dragging&&this.disableUserSelect?ft:gt}},actualHandles(){return!this.resizable&&!this.rotatable?[]:this.handles},computedWidth(){return this.w==="auto"&&!this.widthTouched?"auto":this.width+"px"},computedHeight(){return this.h==="auto"&&!this.heightTouched?"auto":this.height+"px"}},watch:{active(t){this.enabled=t,t?(this.updateParentSize(),this.$emit("activated")):this.$emit("deactivated")},x(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcDragLimits()),this.moveHorizontally(t))},y(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcDragLimits()),this.moveVertically(t))},z(t){(t>=0||t==="auto")&&(this.zIndex=t)},r(t){t>=0&&(this.rotate=t%360)},lockAspectRatio(t){t?this.outsideAspectRatio?this.aspectFactor=this.outsideAspectRatio:this.aspectFactor=this.width/this.height:this.aspectFactor=void 0},outsideAspectRatio(t){t&&(this.aspectFactor=t)},minWidth(t){t>0&&t<=this.width&&(this.minW=t)},minHeight(t){t>0&&t<=this.height&&(this.minH=t)},maxWidth(t){this.maxW=t},maxHeight(t){this.maxH=t},w(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcResizeLimits()),this.changeWidth(t))},h(t){this.resizing||this.dragging||(this.parent&&(this.bounds=this.calcResizeLimits()),this.changeHeight(t))}},created(){this.maxWidth&&this.minWidth>this.maxWidth&&console.warn("[Vdr warn]: Invalid prop: minWidth cannot be greater than maxWidth"),this.maxWidth&&this.minHeight>this.maxHeight&&console.warn("[Vdr warn]: Invalid prop: minHeight cannot be greater than maxHeight"),this.elmX=0,this.elmY=0,this.elmW=0,this.elmH=0,this.lastCenterX=0,this.lastCenterY=0,this.fixedXName="",this.fixedYName="",this.fixedX=0,this.fixedY=0,this.TL={},this.TR={},this.BL={},this.BR={},this.resetBoundsAndMouseState()},mounted(){this.enableNativeDrag||(this.$el.ondragstart=()=>!1);const[t,e]=this.getParentSize();this.parentWidth=t,this.parentHeight=e;const[i,s]=pt(this.$el);this.aspectFactor=(this.w!=="auto"?this.w:i)/(this.h!=="auto"?this.h:s),this.outsideAspectRatio&&(this.aspectFactor=this.outsideAspectRatio),this.width=this.w!=="auto"?this.w:i,this.height=this.h!=="auto"?this.h:s,this.right=this.parentWidth-this.width-this.left,this.bottom=this.parentHeight-this.height-this.top,this.settingAttribute(),P(document.documentElement,"mousedown",this.deselect),P(document.documentElement,"touchend touchcancel",this.deselect),P(window,"resize",this.checkParentSize)},beforeDestroy(){C(document.documentElement,"mousedown",this.deselect),C(document.documentElement,"touchstart",this.handleUp),C(document.documentElement,"mousemove",this.move),C(document.documentElement,"touchmove",this.move),C(document.documentElement,"mouseup",this.handleUp),C(document.documentElement,"touchend touchcancel",this.deselect),C(window,"resize",this.checkParentSize)},methods:{resetBoundsAndMouseState(){this.mouseClickPosition={mouseX:0,mouseY:0,x:0,y:0,w:0,h:0},this.bounds={minLeft:null,maxLeft:null,minRight:null,maxRight:null,minTop:null,maxTop:null,minBottom:null,maxBottom:null}},checkParentSize(){if(this.parent){const[t,e]=this.getParentSize();this.right=t-this.width-this.left,this.bottom=e-this.height-this.top,this.parentWidth=t,this.parentHeight=e}},updateParentSize(){const[t,e]=this.getParentSize();this.parentWidth=t,this.parentHeight=e},getParentSize(){if(this.parent===!0){const t=window.getComputedStyle(this.$el.parentNode,null),e=this.$el.parentNode.getBoundingClientRect();return this.parentX=e.x,this.parentY=e.y,[Math.round(parseFloat(t.getPropertyValue("width"),10)),Math.round(parseFloat(t.getPropertyValue("height"),10))]}if(typeof this.parent=="string"){const t=document.querySelector(this.parent);if(!(t instanceof HTMLElement))throw new Error(`The selector ${this.parent} does not match any element`);return[t.offsetWidth,t.offsetHeight]}return[null,null]},elementTouchDown(t){W=I.touch,this.elementDown(t)},elementMouseDown(t){W=I.mouse,this.elementDown(t)},elementDown(t){if(t instanceof MouseEvent&&t.which!==1)return;const e=t.target||t.srcElement;if(this.$el.contains(e)){if(this.onDragStart(t)===!1)return;if(this.dragHandle&&!ot(e,this.dragHandle,this.$el)||this.dragCancel&&ot(e,this.dragCancel,this.$el)){this.dragging=!1;return}this.enabled||(this.enabled=!0,this.$emit("activated"),this.$emit("update:active",!0)),this.draggable&&(this.dragging=!0),this.mouseClickPosition.mouseX=t.touches?t.touches[0].pageX:t.pageX,this.mouseClickPosition.mouseY=t.touches?t.touches[0].pageY:t.pageY,this.mouseClickPosition.left=this.left,this.mouseClickPosition.right=this.right,this.mouseClickPosition.top=this.top,this.mouseClickPosition.bottom=this.bottom,this.mouseClickPosition.width=this.width,this.mouseClickPosition.height=this.height,this.parent&&(this.bounds=this.calcDragLimits()),P(document.documentElement,W.move,this.move),P(document.documentElement,W.stop,this.handleUp)}},calcDragLimits(){return this.rotatable?{minLeft:-this.width/2,maxLeft:this.parentWidth-this.width/2,minRight:this.width/2,maxRight:this.parentWidth+this.width/2,minTop:-this.height/2,maxTop:this.parentHeight-this.height/2,minBottom:this.height/2,maxBottom:this.parentHeight+this.height/2}:{minLeft:this.left%this.grid[0],maxLeft:Math.floor((this.parentWidth-this.width-this.left)/this.grid[0])*this.grid[0]+this.left,minRight:this.right%this.grid[0],maxRight:Math.floor((this.parentWidth-this.width-this.right)/this.grid[0])*this.grid[0]+this.right,minTop:this.top%this.grid[1],maxTop:Math.floor((this.parentHeight-this.height-this.top)/this.grid[1])*this.grid[1]+this.top,minBottom:this.bottom%this.grid[1],maxBottom:Math.floor((this.parentHeight-this.height-this.bottom)/this.grid[1])*this.grid[1]+this.bottom}},deselect(t){const e=t.target||t.srcElement,i=new RegExp(this.className+"-([trmbl]{2})","");!this.$el.contains(e)&&!i.test(e.className)&&(this.enabled&&!this.preventDeactivation&&(this.enabled=!1,this.$emit("deactivated"),this.$emit("update:active",!1)),C(document.documentElement,W.move,this.move)),this.resetBoundsAndMouseState()},handleTouchDown(t,e){W=I.touch,this.handleDown(t,e)},handleDown(t,e){if(e instanceof MouseEvent&&e.which!==1||this.onResizeStart(t,e)===!1)return!1;e.stopPropagation&&e.stopPropagation(),this.handle=t,this.handle==="rot"?this.rotating=!0:this.resizing=!0;let{top:i,left:s,width:o,height:h}=this.$el.getBoundingClientRect();this.lastCenterX=window.pageXOffset+s+o/2,this.lastCenterY=window.pageYOffset+i+h/2;let l=this.left,c=this.top,n=this.width,r=this.height,u=l+n/2,p=c+r/2,a=this.rotate;this.TL=$(u,p,l,c,a),this.TR=$(u,p,l+n,c,a),this.BL=$(u,p,l,c+r,a),this.BR=$(u,p,l+n,c+r,a),this.mouseClickPosition.mouseX=e.touches?e.touches[0].pageX:e.pageX,this.mouseClickPosition.mouseY=e.touches?e.touches[0].pageY:e.pageY,this.mouseClickPosition.left=this.left,this.mouseClickPosition.right=this.right,this.mouseClickPosition.top=this.top,this.mouseClickPosition.bottom=this.bottom,this.mouseClickPosition.width=this.width,this.mouseClickPosition.height=this.height,this.bounds=this.calcResizeLimits(),P(document.documentElement,W.move,this.move),P(document.documentElement,W.stop,this.handleUp)},calcResizeLimits(){let t=this.minW,e=this.minH,i=this.maxW,s=this.maxH;const[o,h]=this.grid,l=this.width,c=this.height,n=this.left,r=this.top,u=this.right,p=this.bottom;i=i-i%o,s=s-s%h;const a={minLeft:null,maxLeft:null,minTop:null,maxTop:null,minRight:null,maxRight:null,minBottom:null,maxBottom:null};return this.parent?(a.minLeft=n,a.maxLeft=n+Math.floor((l-t)/o),a.minTop=r,a.maxTop=r+Math.floor((c-e)/h),a.minRight=u,a.maxRight=u+Math.floor((l-t)/o),a.minBottom=p,a.maxBottom=p+Math.floor((c-e)/h),i&&(a.minLeft=Math.max(a.minLeft,this.parentWidth-u-i),a.minRight=Math.max(a.minRight,this.parentWidth-n-i)),s&&(a.minTop=Math.max(a.minTop,this.parentHeight-p-s),a.minBottom=Math.max(a.minBottom,this.parentHeight-r-s))):(a.minLeft=null,a.maxLeft=n+Math.floor(l-t),a.minTop=null,a.maxTop=r+Math.floor(c-e),a.minRight=null,a.maxRight=u+Math.floor(l-t),a.minBottom=null,a.maxBottom=p+Math.floor(c-e),i&&(a.minLeft=-(u+i),a.minRight=-(n+i)),s&&(a.minTop=-(p+s),a.minBottom=-(r+s)),this.lockAspectRatio&&i&&s&&(a.minLeft=Math.min(a.minLeft,-(u+i)),a.minTop=Math.min(a.minTop,-(s+p)),a.minRight=Math.min(a.minRight,-n-i),a.minBottom=Math.min(a.minBottom,-r-s))),a},move(t){this.resizing?this.handleResize(t):this.dragging?this.handleDrag(t):this.rotating&&this.handleRotate(t)},getMouseCoordinate(t){return t.type.indexOf("touch")!==-1?{x:t.changedTouches[0].clientX,y:t.changedTouches[0].clientY}:{x:t.pageX||t.clientX+document.documentElement.scrollLeft,y:t.pageY||t.clientY+document.documentElement.scrollTop}},handleRotate(t){const{x:e,y:i}=this.getMouseCoordinate(t),s=e-this.lastCenterX,o=i-this.lastCenterY;this.rotate=(mt(s,o)+90)%360,this.$emit("rotating",this.rotate)},async handleDrag(t){const e=this.axis,i=this.grid,s=this.bounds,o=this.mouseClickPosition,h=e&&e!=="y"?o.mouseX-(t.touches?t.touches[0].pageX:t.pageX):0,l=e&&e!=="x"?o.mouseY-(t.touches?t.touches[0].pageY:t.pageY):0,[c,n]=Y(i,h,l,this.scaleRatio),r=T(o.left-c,s.minLeft,s.maxLeft),u=T(o.top-n,s.minTop,s.maxTop);if(this.onDrag(r,u)===!1)return;const p=T(o.right+c,s.minRight,s.maxRight),a=T(o.bottom+n,s.minBottom,s.maxBottom);this.left=r,this.top=u,this.right=p,this.bottom=a,await this.snapCheck(),this.$emit("dragging",this.left,this.top)},moveHorizontally(t){const[e,i]=Y(this.grid,t,this.top,this.scale),s=T(e,this.bounds.minLeft,this.bounds.maxLeft);this.left=s,this.right=this.parentWidth-this.width-s},moveVertically(t){const[e,i]=Y(this.grid,this.left,t,this.scale),s=T(i,this.bounds.minTop,this.bounds.maxTop);this.top=s,this.bottom=this.parentHeight-this.height-s},handleResize(t){const e=this.handle,i=this.scaleRatio,{TL:s,TR:o,BL:h,BR:l}=this;let{x:c,y:n}=this.getMouseCoordinate(t);!this.rotatable&&this.parent&&(c=T(c,this.parentX,this.parentX+this.parentWidth*i),n=T(n,this.parentY,this.parentY+this.parentHeight*i));let r=c-this.mouseClickPosition.mouseX,u=n-this.mouseClickPosition.mouseY;r=r/i,u=u/i;let p,a,y,L,R,b,w,H,M,d={},f={},g={},x={},m={},N={},v={},S={};if(e.includes("m")){switch(e){case"tm":p=r+(s.x+o.x)/2,a=u+(s.y+o.y)/2,d=h,f=s,g=l,x={x:p-d.x,y:a-d.y},m={x:f.x-d.x,y:f.y-d.y},y=(x.x*m.x+x.y*m.y)/(Math.pow(m.x,2)+Math.pow(m.y,2)),v={x:g.x-d.x,y:g.y-d.y},S={x:m.x*y,y:m.y*y};break;case"bm":p=r+(h.x+l.x)/2,a=u+(h.y+l.y)/2,d=s,f=h,g=o,x={x:p-d.x,y:a-d.y},m={x:f.x-d.x,y:f.y-d.y},y=(x.x*m.x+x.y*m.y)/(Math.pow(m.x,2)+Math.pow(m.y,2)),v={x:g.x-d.x,y:g.y-d.y},S={x:m.x*y,y:m.y*y};break;case"ml":p=r+(s.x+h.x)/2,a=u+(s.y+h.y)/2,d=l,f=h,g=o,x={x:p-d.x,y:a-d.y},m={x:f.x-d.x,y:f.y-d.y},y=(x.x*m.x+x.y*m.y)/(Math.pow(m.x,2)+Math.pow(m.y,2)),S={x:g.x-d.x,y:g.y-d.y},v={x:m.x*y,y:m.y*y};break;case"mr":p=r+(o.x+o.x)/2,a=u+(o.y+o.y)/2,d=h,f=l,g=s,x={x:p-d.x,y:a-d.y},m={x:f.x-d.x,y:f.y-d.y},y=(x.x*m.x+x.y*m.y)/(Math.pow(m.x,2)+Math.pow(m.y,2)),S={x:g.x-d.x,y:g.y-d.y},v={x:m.x*y,y:m.y*y};break}b=d.x+(v.x+S.x)/2,w=d.y+(v.y+S.y)/2,H=Math.sqrt(Math.pow(v.x,2)+Math.pow(v.y,2)),M=Math.sqrt(Math.pow(S.x,2)+Math.pow(S.y,2))}else{switch(e){case"tl":p=r+s.x,a=u+s.y,d=l,f=h,g=o;break;case"tr":p=r+o.x,a=u+o.y,d=h,f=l,g=s;break;case"bl":p=r+h.x,a=u+h.y,d=o,f=s,g=l;break;case"br":p=r+l.x,a=u+l.y,d=s,f=o,g=h;break}x={x:p-d.x,y:a-d.y},m={x:f.x-d.x,y:f.y-d.y},N={x:g.x-d.x,y:g.y-d.y},L=(x.x*m.x+x.y*m.y)/(Math.pow(m.x,2)+Math.pow(m.y,2)),R=(x.x*N.x+x.y*N.y)/(Math.pow(N.x,2)+Math.pow(N.y,2)),v={x:m.x*L,y:m.y*L},S={x:N.x*R,y:N.y*R},b=d.x+(v.x+S.x)/2,w=d.y+(v.y+S.y)/2,H=Math.sqrt(Math.pow(v.x,2)+Math.pow(v.y,2)),M=Math.sqrt(Math.pow(S.x,2)+Math.pow(S.y,2))}this.left=b-H/2,this.top=w-M/2,H=T(H,this.minW||0,this.maxW),M=T(M,this.minH||0,this.maxH),this.parent&&(H=T(H,0,this.parentWidth),M=T(M,0,this.parentHeight)),this.lockAspectRatio&&(console.log(this.lockAspectRatio,this.aspectFactor),H/M>this.aspectFactor?H=M*this.aspectFactor:M=H/this.aspectFactor),this.width=H,this.height=M,this.$emit("resizing",this.left,this.top,this.width,this.height)},changeWidth(t){const[e,i]=Y(this.grid,t,0,this.scale),s=this.parentWidth-e-this.left;let o=this.bottom;this.lockAspectRatio&&(o=this.bottom-(this.right-s)/this.aspectFactor);const h=it(this.parentWidth,this.left,s),l=st(this.parentHeight,this.top,o);this.right=s,this.bottom=o,this.width=h,this.height=l},changeHeight(t){const[e,i]=Y(this.grid,0,t,this.scale),s=this.parentHeight-i-this.top;let o=this.right;this.lockAspectRatio&&(o=this.right-(this.bottom-s)*this.aspectFactor);const h=it(this.parentWidth,this.left,o),l=st(this.parentHeight,this.top,s);this.right=o,this.bottom=s,this.width=h,this.height=l},async handleUp(t){this.handle=null;const e=new Array(3).fill({display:!1,position:"",origin:"",lineLength:""}),i={vLine:[],hLine:[]};for(const h in i)i[h]=JSON.parse(JSON.stringify(e));const{x:s,y:o}=this.getMouseCoordinate(t);this.lastMouseX=s,this.lastMouseY=o,this.resizing&&(this.resizing=!1,await this.conflictCheck(),this.$emit("refLineParams",i),this.$emit("resizestop",this.left,this.top,this.width,this.height)),this.dragging&&(this.dragging=!1,await this.conflictCheck(),this.$emit("refLineParams",i),this.$emit("dragstop",this.left,this.top)),this.rotating&&(this.rotating=!1,this.$emit("rotatestop",this.rotate)),this.resetBoundsAndMouseState(),C(document.documentElement,W.move,this.move)},settingAttribute(){this.$el.setAttribute("data-is-check",`${this.isConflictCheck}`),this.$el.setAttribute("data-is-snap",`${this.snap}`)},conflictCheck(){const t=this.top,e=this.left,i=this.width,s=this.height;if(this.isConflictCheck){const o=this.$el.parentNode.childNodes;for(const h of o)if(h.className!==void 0&&!h.className.split(" ").includes(this.classNameActive)&&h.getAttribute("data-is-check")!==null&&h.getAttribute("data-is-check")!=="false"){const l=h.offsetWidth,c=h.offsetHeight,[n,r]=this.formatTransformVal(h.style.transform),u=t>=r&&e>=n&&r+c>t&&n+l>e||t<=r&&e<n&&t+s>r&&e+i>n,p=e<=n&&t>=r&&e+i>n&&t<r+c||t<r&&e>n&&t+s>r&&e<n+l,a=t<=r&&e>=n&&t+s>r&&e<n+l||t>=r&&e<=n&&t<r+c&&e>n+l,y=t<=r&&e>=n&&t+s>r&&e<n+l||t>=r&&e<=n&&t<r+c&&e>n+l,L=e>=n&&t>=r&&e<n+l&&t<r+c||t>r&&e<=n&&e+i>n&&t<r+c,R=t<=r&&e>=n&&t+s>r&&e<n+l||t>=r&&e<=n&&t<r+c&&e+i>n;(u||p||a||y||L||R)&&(this.top=this.mouseClickPosition.top,this.left=this.mouseClickPosition.left,this.width=this.mouseClickPosition.width,this.height=this.mouseClickPosition.height)}}},async snapCheck(){if(this.snap){let t=this.width,e=this.height,i=this.left,s=this.left+t,o=this.top,h=this.top+e;const l=new Array(3).fill({display:!1,position:"",origin:"",lineLength:""}),c={vLine:[],hLine:[]};for(const R in c)c[R]=JSON.parse(JSON.stringify(l));const n={value:{x:[[],[],[]],y:[[],[],[]]},display:[],position:[]},r=this.$el.parentNode.childNodes,{groupWidth:u,groupHeight:p,groupLeft:a,groupTop:y,bln:L}=await this.getActiveAll(r);L||(t=u,e=p,i=a,s=a+u,o=y,h=y+p);for(const R of r)if(R.className!==void 0&&!R.className.split(" ").includes(this.classNameActive)&&R.getAttribute("data-is-snap")!==null&&R.getAttribute("data-is-snap")!=="false"){const[b,w,H]=this.formatTransformVal(R.style.transform);if((H-this.rotate)%90===0){const M=R.offsetWidth,d=R.offsetHeight,f=b+M,g=w+d,x=Math.abs(o+e/2-(w+d/2))<=this.snapTolerance,m=Math.abs(i+t/2-(b+M/2))<=this.snapTolerance,N=Math.abs(w-h)<=this.snapTolerance,v=Math.abs(g-h)<=this.snapTolerance,S=Math.abs(w-o)<=this.snapTolerance,U=Math.abs(g-o)<=this.snapTolerance,O=Math.abs(b-s)<=this.snapTolerance,q=Math.abs(f-s)<=this.snapTolerance,J=Math.abs(b-i)<=this.snapTolerance,j=Math.abs(f-i)<=this.snapTolerance;n.display=[N,v,S,U,x,x,O,q,J,j,m,m],n.position=[w,g,w,g,w+d/2,w+d/2,b,f,b,f,b+M/2,b+M/2],L&&(N&&(this.top=w-e,this.bottom=this.parentHeight-this.top-e,n.value.y[0].push(b,f,i,s)),S&&(this.top=w,this.bottom=this.parentHeight-this.top-e,n.value.y[0].push(b,f,i,s)),v&&(this.top=g-e,this.bottom=this.parentHeight-this.top-e,n.value.y[1].push(b,f,i,s)),U&&(this.top=g,this.bottom=this.parentHeight-this.top-e,n.value.y[1].push(b,f,i,s)),O&&(this.left=b-t,this.right=this.parentWidth-this.left-t,n.value.x[0].push(w,g,o,h)),J&&(this.left=b,this.right=this.parentWidth-this.left-t,n.value.x[0].push(w,g,o,h)),q&&(this.left=f-t,this.right=this.parentWidth-this.left-t,n.value.x[1].push(w,g,o,h)),j&&(this.left=f,this.right=this.parentWidth-this.left-t,n.value.x[1].push(w,g,o,h)),x&&(this.top=w+d/2-e/2,this.bottom=this.parentHeight-this.top-e,n.value.y[2].push(b,f,i,s)),m&&(this.left=b+M/2-t/2,this.right=this.parentWidth-this.left-t,n.value.x[2].push(w,g,o,h)),this.snapBorder&&(Math.abs(this.left-0)<=this.snapTolerance&&(this.left=0,this.right=this.parentWidth-this.left-t),Math.abs(this.right-0)<=this.snapTolerance&&(this.right=0,this.left=this.parentWidth-this.width-this.right),Math.abs(this.top-0)<=this.snapTolerance&&(this.top=0,this.bottom=this.parentHeight-this.top-e),Math.abs(this.bottom-0)<=this.snapTolerance&&(this.bottom=0,this.top=this.parentHeight-this.bottom-e)));let k=this.bounds;this.left=T(this.left,k.minLeft,k.maxLeft),this.top=T(this.top,k.minTop,k.maxTop),this.right=T(this.right,k.minRight,k.maxRight),this.bottom=T(this.bottom,k.minBottom,k.maxBottom);const E=[0,1,0,1,2,2,0,1,0,1,2,2];for(let z=0;z<=E.length;z++){const ht=z<6?"y":"x",D=z<6?"hLine":"vLine";if(n.display[z]){const{origin:nt,length:at}=this.calcLineValues(n.value[ht][E[z]]);c[D][E[z]].display=n.display[z],c[D][E[z]].position=n.position[z]+"px",c[D][E[z]].origin=nt,c[D][E[z]].lineLength=at}}}}this.$emit("refLineParams",c)}},calcLineValues(t){const e=Math.max(...t)-Math.min(...t)+"px",i=Math.min(...t)+"px";return{length:e,origin:i}},async getActiveAll(t){const e=[],i=[],s=[];let o=0,h=0,l=0,c=0;for(const u of t)u.className!==void 0&&u.className.split(" ").includes(this.classNameActive)&&e.push(u);const n=e.length;if(n>1){for(const u of e){const p=u.offsetLeft,a=p+u.offsetWidth,y=u.offsetTop,L=y+u.offsetHeight;i.push(p,a),s.push(y,L)}o=Math.max(...i)-Math.min(...i),h=Math.max(...s)-Math.min(...s),l=Math.min(...i),c=Math.min(...s)}return{groupWidth:o,groupHeight:h,groupLeft:l,groupTop:c,bln:n===1}},formatTransformVal(t){let[e,i,s=0]=t.match(/[\d|\.]+/g);return i===void 0&&(i=0),[Number(e),Number(i),s]}}},yt=["onMousedown","onTouchstart"];function bt(t,e,i,s,o,h){return F(),V("div",{style:K(h.style),class:G([{[i.classNameActive]:o.enabled,[i.classNameDragging]:o.dragging,[i.classNameResizing]:o.resizing,[i.classNameDraggable]:i.draggable,[i.classNameResizable]:i.resizable,[i.classNameRotating]:o.rotating,[i.classNameRotatable]:i.rotatable},i.className]),onMousedown:e[0]||(e[0]=(...l)=>h.elementMouseDown&&h.elementMouseDown(...l)),onTouchstart:e[1]||(e[1]=(...l)=>h.elementTouchDown&&h.elementTouchDown(...l))},[(F(!0),V(rt,null,ct(h.actualHandles,(l,c)=>(F(),V("div",{key:c,class:G([i.classNameHandle,i.classNameHandle+"-"+l]),style:K(h.handleStyle(l,c)),onMousedown:Q(n=>h.handleDown(l,n),["stop","prevent"]),onTouchstart:Q(n=>h.handleTouchDown(l,n),["stop","prevent"])},[Z(t.$slots,l,{},void 0,!0)],46,yt))),128)),Z(t.$slots,"default",{},void 0,!0)],38)}const wt=lt(xt,[["render",bt],["__scopeId","data-v-a7d3ae59"]]),Mt={class:"screen-editor"},vt={class:"asider"},St=A("div",{class:"ul"},[A("li",null,"图文"),A("li",null,"单页"),A("li",null,"装饰")],-1),Tt={class:"container1"},Rt=A("p",null,"banner",-1),Ht={class:"config"},Lt=dt({__name:"index",setup(t){const e=ut("first"),i=(s,o)=>{console.log(s,o)};return(s,o)=>{const h=tt("el-tab-pane"),l=tt("el-tabs");return F(),V("div",Mt,[A("div",vt,[St,_(l,{modelValue:e.value,"onUpdate:modelValue":o[0]||(o[0]=c=>e.value=c),class:"demo-tabs",onTabClick:i},{default:B(()=>[_(h,{label:"推荐",name:"second"},{default:B(()=>[X("推荐")]),_:1}),_(h,{label:"收藏",name:"third"},{default:B(()=>[X("收藏")]),_:1})]),_:1},8,["modelValue"])]),A("div",Tt,[_(wt,{parent:!0,w:414,height:100},{default:B(()=>[Rt]),_:1})]),A("div",Ht,[_(l,{modelValue:e.value,"onUpdate:modelValue":o[1]||(o[1]=c=>e.value=c),class:"demo-tabs",onTabClick:i},{default:B(()=>[_(h,{label:"页面设置",name:"second"},{default:B(()=>[X("页面设置")]),_:1}),_(h,{label:"图层管理",name:"third"},{default:B(()=>[X("图层管理")]),_:1}),_(h,{label:"页面管理",name:"third"},{default:B(()=>[X("页面管理")]),_:1})]),_:1},8,["modelValue"])])])}}});export{Lt as default};
